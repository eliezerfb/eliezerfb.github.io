<!DOCTYPE html>
<html lang="pt">
<head>
        <meta charset="utf-8" />
        <title>Eliézer Bourchardt Personal Blog - data science</title>
        <link rel="stylesheet" href="http://eliezerfb.eti.br/theme/css/main.css" />
        <link href="http://eliezerfb.eti.br/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Eliézer Bourchardt Personal Blog Atom Feed" />

        <!--[if IE]>
            <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="http://eliezerfb.eti.br/">Eliézer Bourchardt Personal Blog </a></h1>
                <nav><ul>
                    <li><a href="http://eliezerfb.eti.br/category/data-science.html">Data Science</a></li>
                    <li><a href="http://eliezerfb.eti.br/category/python.html">Python</a></li>
                </ul></nav>
        </header><!-- /#banner -->

            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="http://eliezerfb.eti.br/dicas-cata-cleaning.html">Dicas de Data Cleaning</a></h1>
<footer class="post-info">
        <abbr class="published" title="2018-03-31T20:23:00-03:00">
                Published: Sáb 31 março 2018
        </abbr>
		<br />
        <abbr class="modified" title="2018-03-31T20:23:00-03:00">
                Updated: Sáb 31 março 2018
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="http://eliezerfb.eti.br/author/eliezer.html">Eliézer</a>
        </address>
<p>In <a href="http://eliezerfb.eti.br/category/data-science.html">Data Science</a>.</p>
<p>tags: <a href="http://eliezerfb.eti.br/tag/data-science.html">data science</a> <a href="http://eliezerfb.eti.br/tag/data-cleaning.html">data cleaning</a> </p>
</footer><!-- /.post-info --><p>O processo de limpeza e preparação dos dados representa cerca de 80% do trabalho de um cientista de dados. Datas em diversos formatos, diversos encodings, dados incompletos, erros de digitação são muito comuns. Antes de realizar qualquer análise é necessário tratar estes problemas. Neste post reúno algumas dicas de pré-processamento que são úteis no dia-a-dia.</p>
<h1>Manipulação de Dados Faltantes</h1>
<p>Para obter o número de pontos de dados perdidos por coluna, podemos utilizar o código:</p>
<div class="highlight"><pre><span></span>missing_values_count = df.isnull().sum()
total_cells = np.product(df.shape)
total_missing = missing_values_count.sum()
print((total_missing/total_cells) * 100)
</pre></div>


<p>Também podemos visualizar os dados faltantes com a ajuda da biblioteca <a href="https://github.com/ResidentMario/missingno">missingno</a>. </p>
<div class="highlight"><pre><span></span>pip install missingno
</pre></div>


<p>Esta biblioteca permite diversas visualizações, abaixo é possível ver um exemplo de código:    </p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">quilt.data.ResidentMario</span> <span class="kn">import</span> <span class="n">missingno_data</span>
<span class="n">collisions</span> <span class="o">=</span> <span class="n">missingno_data</span><span class="o">.</span><span class="n">nyc_injurious_collisions</span><span class="p">()</span>
<span class="n">collisions</span> <span class="o">=</span> <span class="n">collisions</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">missingno</span> <span class="kn">as</span> <span class="nn">msno</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="n">msno</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">collisions</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">250</span><span class="p">))</span>
</pre></div>


<p><img alt="msgno example" class="img-responsive" height="90%" src="/images/msgno.png" width="90%"></p>
<p>Mas nem todos dados faltantes são erros. Nesse momento é necessário se perguntar: <strong>um dado faltante é porque não foi gravado ou porque não existe?</strong></p>
<p>Se um valor é faltante porque ele não existe (como a altura do filho mais velho de quem não tem filhos), então não faz sentido tentar adivinhar este valor. Estes valores devem ser mantidos como NaN. Por outro lado, se um valor não existe porque não foi gravado, então podemos tentar adivinhar seu valor baseado em outros valores nesta coluna e linha. </p>
<h2>Descartar valores ausentes</h2>
<p>Se não houver uma razão para descobrir por que os valores estão faltando, uma opção é apenas remover as linhas ou colunas que contiverem valores ausentes. Porém esta abordagem não é muito recomendada, principalmente em projetos importantes. Vale a pena dedicar um tempo para analisar os dados e observar todas as colunas com valores ausentes um a um para realmente conhecer o dataset.  </p>
<p>O código abaixo remove todas as linhas que contém um valor faltante:  </p>
<div class="highlight"><pre><span></span>df.dropna()
</pre></div>


<p>E para remover todas as colunas que contiver um valor faltante, basta informar axis=1:  s</p>
<div class="highlight"><pre><span></span>df.dropna(axis=1)
</pre></div>


<h2>Preencher valores ausentes automáticamente</h2>
<p>Outra opção é tentar preencher os valores ausentes. Para preencher todos NaN com zero:  </p>
<div class="highlight"><pre><span></span>df.fillna(0)
</pre></div>


<p>Para um conjunto de dados que possuem uma ordem lógica pode ser feito dessa forma:  </p>
<div class="highlight"><pre><span></span>df.fillna(method = &#39;bfill&#39;, axis=0).fillna(&quot;0&quot;)
</pre></div>


<p>O método bfill preenche os valores ausentes com qualquer valor que venha diretamente após ele na mesma coluna. Um exemplo de uso pode ser na observação de temperatura ou dados pluviométricos.  </p>
<p>Veja também:
<a href="https://www.kaggle.com/rtatman/data-cleaning-challenge-handling-missing-values">Data cleaning challenge by Kaggle</a>  </p>                </article>
            </aside><!-- /#featured -->
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="http://getpelican.com/">Pelican</a></li>
                            <li><a href="http://python.org/">Python.org</a></li>
                            <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="http://eliezerfb.eti.br/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                            <li><a href="https://www.linkedin.com/in/eliezer-bourchardt/">Linkedin</a></li>
                            <li><a href="https://github.com/eliezerfb">GitHub</a></li>
                            <li><a href="https://twitter.com/eliezerfb">Twitter</a></li>
                            <li><a href="https://www.facebook.com/eliezer.bourchardt">Facebook</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>